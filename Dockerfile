# Базовий образ
FROM node:20-alpine

# Робоча директорія всередині контейнера
WORKDIR /usr/src/app

# Спочатку копіюємо тільки package-файли (для кешу)
COPY package*.json ./

# Встановлюємо залежності (включно з dev, щоб був nodemon, якщо треба)
RUN npm install

# Копіюємо увесь код
COPY . .

# Створимо директорію для кешу (на всяк випадок)
RUN mkdir -p cache

# Порт, на якому працює застосунок
EXPOSE 3000

# За замовчуванням запускаємо додаток з потрібними CLI-параметрами
# host = 0.0.0.0, щоб було доступно ззовні контейнера
CMD ["node", "index.js", "--host", "0.0.0.0", "--port", "3000", "--cache", "./cache"]
